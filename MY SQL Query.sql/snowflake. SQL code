SELECT*
FROM CASE_STUDY1.BRIGHTLEARN.COFFEE_SHOP
LIMIT 20;

----------------------S------------------------------------------------------------------------------------------------------------------------------------- Revenue per transaction 
SELECT transaction_id,
       transaction_qty*unit_price AS revenue
FROM case_study1.brightlearn.coffee_shop;

-- Remember that with the ID's we use the COUNT NOT SUM 
-- This is the total number of sales/transactions made
SELECT COUNT(transaction_id) AS number_of_transactions
FROM case_study1.brightlearn.coffee_shop;

--COUNT the number of different shops we have in this data 
SELECT COUNT(DISTINCT store_id) AS number_of_shops
FROM case_study1.brightlearn.coffee_shop;

-- To show us the name of the different store location which is actually 3 different shops
SELECT DISTINCT store_location, store_id
FROM case_study1.brightlearn.coffee_shop;

--How to calculate the revenue by store location 
SELECT store_location,
       SUM(transaction_qty*unit_price) AS revenue
FROM case_study1.brightlearn.coffee_shop
GROUP BY store_location;

-- What time does the shop opens
SELECT MIN(transaction_time) openig_time
FROM case_study1.brightlearn.coffee_shop;

-- What time does the shop close
SELECT MAX(transaction_time) closing_time
FROM case_study1.brightlearn.coffee_shop;


SELECT product_category,
       SUM(transaction_qty*unit_price) AS revenue,
       store_location,
       transaction_date,
       transaction_time,
       CASE
            WHEN transaction_time BETWEEN '06:00:00' AND '11:59:59' THEN '01. Morning'
            WHEN transaction_time BETWEEN '12:00:00' AND '15:59:59' THEN '02. Aftenoon'
            WHEN transaction_time BETWEEN '16:00:00' AND '19:59:59' THEN '03. Evening'
            WHEN transaction_time >= '20:00:00'  THEN '04. Night'
        END AS time_bucket
FROM case_study1.brightlearn.coffee_shop
WHERE transaction_date>'2023-05-01'
GROUP BY product_category,
         store_location,
         transaction_date,
         time_bucket,
         transaction_time,
         unit_price
         
ORDER BY revenue DESC;




